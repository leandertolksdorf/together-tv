{"version":3,"sources":["Subpage.module.css","App.module.css","components/Button/index.js","App.js","Subpage.js","Router.js","index.js","components/Button/Button.module.css"],"names":["module","exports","Button","href","onClick","children","console","log","inner","undefined","className","style","button","App","id","useState","ws","setWs","inputUrl","setInputUrl","inviteLinkCopied","setInviteLinkCopied","playerRef","useRef","mediaSource","setMediaSource","progress","setProgress","playing","setPlaying","useEffect","wsURL","window","location","hostname","port","wsClient","WebSocket","onbeforeunload","onclose","close","onopen","send","JSON","stringify","command","groupId","onmessage","message","payload","parse","data","url","current","seekTo","time","app","animation","form","onSubmit","e","preventDefault","type","placeholder","value","onChange","target","sources","playerWrapper","player","reactPlayer","ref","onReady","onProgress","played","progressInterval","width","height","control","progressBarWrapper","newProgress","nativeEvent","offsetX","offsetWidth","duration","getDuration","progressBar","String","playControl","alt","playButton","getCurrentTime","handlePause","handlePlay","src","fullscreenButton","document","fullscreenElement","exitFullscreen","getElementById","requestFullscreen","buttons","element","select","setSelectionRange","execCommand","hidden","readOnly","links","Subpage","wrapper","history","back","Router","path","params","to","Math","random","toString","substr","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.47a36d4d.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"backlink\":\"Subpage_backlink__1jT4J\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"App_app__1kX79\",\"playerWrapper\":\"App_playerWrapper__1sB4G\",\"player\":\"App_player__1wNcv\",\"form\":\"App_form__30Y9M\",\"sources\":\"App_sources__Tea2d\",\"reactPlayer\":\"App_reactPlayer__2C7T5\",\"progressBarWrapper\":\"App_progressBarWrapper__3rUGj\",\"progressBar\":\"App_progressBar__3Ro_O\",\"control\":\"App_control__1mvlH\",\"playControl\":\"App_playControl__1TkDw\",\"playButton\":\"App_playButton__38Hm1\",\"fullscreenButton\":\"App_fullscreenButton__1gL00\",\"links\":\"App_links__h6CZe\",\"hidden\":\"App_hidden__3ofBD\",\"buttons\":\"App_buttons__32eX7\",\"button\":\"App_button__13pio\"};","import React from \"react\"\nimport style from \"./Button.module.css\"\n\nfunction Button({ href, onClick, children }) {\n  console.log(href)\n  // If href render anchor, else div\n  const inner = (href !== undefined)\n    ? <a className={style.inner} href={href}>{children}</a>\n    : <div className={style.inner} onClick={onClick}>{children}</div>\n\n  return (\n    <div\n      className={style.button}\n    >\n      {inner}\n    </div>\n  )\n}\n\nexport default Button","import { useState, useRef, useEffect } from \"react\"\nimport ReactPlayer from \"react-player\"\nimport { Link } from \"wouter\"\nimport style from \"./App.module.css\"\nimport Button from \"./components/Button\"\n\nfunction App({ id }) {\n  // Websocket\n  const [ws, setWs] = useState(null)\n\n  // Form and media source state\n  const [inputUrl, setInputUrl] = useState(\"\")\n  const [inviteLinkCopied, setInviteLinkCopied] = useState(false)\n\n  // Player state\n  const playerRef = useRef()\n  const [mediaSource, setMediaSource] = useState()\n  const [progress, setProgress] = useState(0)\n  const [playing, setPlaying] = useState(false)\n\n  const onSubmit = e => {\n    if (e) {\n      e.preventDefault()\n    }\n    const message = JSON.stringify({\n      command: \"media\",\n      url: inputUrl,\n      groupId: id\n    })\n    ws.send(message)\n  }\n\n  // Player control handlers\n\n  const toggleFullsreen = () => {\n    if (!document.fullscreenElement) {\n      document.getElementById(style.playerWrapper).requestFullscreen()\n    } else {\n      if (document.exitFullscreen) {\n        document.exitFullscreen()\n      }\n    }\n  }\n\n  const handleProgressBarClick = e => {\n    const newProgress = e.nativeEvent.offsetX / e.target.offsetWidth\n    const duration = playerRef.current.getDuration()\n    const message = JSON.stringify({\n      command: \"seek\",\n      time: newProgress * duration,\n      groupId: id\n    })\n    console.log(message, duration, newProgress)\n    ws.send(message)\n  }\n\n  const handleReady = () => {}\n\n  const handlePlay = () => {\n    const message = JSON.stringify({\n      command: \"play\",\n      time: playerRef.current.getCurrentTime(),\n      groupId: id\n    })\n    ws.send(message)\n  }\n\n  const handlePause = () => {\n    const message = JSON.stringify({\n      command: \"pause\",\n      time: playerRef.current.getCurrentTime(),\n      groupId: id\n    })\n    ws.send(message)\n  }\n\n  const handleProgress = ({ played }) => {\n    setProgress(played)\n    const message = JSON.stringify({\n      command: \"progress\",\n      time: played,\n      groupId: id\n    })\n    ws.send(message)\n  }\n\n  // Other\n\n  const handleInviteLinkCopy = () => {\n    const element = document.getElementById(\"invite-link\")\n    element.select()\n    element.setSelectionRange(0, 99999)\n\n    document.execCommand(\"copy\")\n    setInviteLinkCopied(true)\n  }\n\n  const rickRoll = () => {\n    var message = JSON.stringify({\n      command: \"media\",\n      url: \"https://www.youtube.com/watch?v=dQw4w9WgXcQ\",\n      groupId: id\n    })\n    ws.send(message)\n    message = JSON.stringify({ command: \"play\", time: 0, groupId: id })\n    ws.send(message)\n  }\n\n  useEffect(() => {\n    const wsURL =\n      process.env.NODE_ENV === \"production\"\n        ? \"wss://\" + window.location.hostname + \":\" + window.location.port\n        : \"ws://localhost:4000\"\n\n    const wsClient = new WebSocket(wsURL)\n\n    window.onbeforeunload = function () {\n      wsClient.onclose = function () {} // disable onclose handler first\n      wsClient.close()\n    }\n\n    wsClient.onopen = () => {\n      console.log(\"opened\")\n      wsClient.send(JSON.stringify({ command: \"connected\", groupId: id }))\n    }\n\n    wsClient.onmessage = message => {\n      const payload = JSON.parse(message.data)\n      // console.log(\"Received payload: \", payload)\n      // setReceivedMessages([...receivedMessages, message.data])\n\n      switch (payload.command) {\n        case \"media\":\n          setMediaSource(payload.url)\n          break\n        case \"play\":\n          playerRef.current.seekTo(payload.time)\n          setPlaying(true)\n          break\n        case \"pause\":\n          setPlaying(false)\n          playerRef.current.seekTo(payload.time)\n          break\n        case \"seek\":\n          playerRef.current.seekTo(payload.time)\n          break\n        default:\n          break\n      }\n    }\n    setWs(wsClient)\n  }, [id])\n\n  return (\n    <>\n      <div\n        className={style.app}\n        style={{ animation: \"fadeIn .5s ease-in-out\" }}\n      >\n        <form id=\"media-source\" className={style.form} onSubmit={onSubmit}>\n          <input\n            type=\"text\"\n            placeholder=\"Enter a source to play.\"\n            value={inputUrl}\n            onChange={e => setInputUrl(e.target.value)}\n          ></input>\n          <span className={style.sources}>\n            YouTube | Vimeo | Dailymotion | Facebook | Mixcloud | Soundcloud |\n            Twitch | Streamable | Video files | Audio files ...\n          </span>\n        </form>\n        <div id={style.playerWrapper}>\n          <div className={style.player}>\n            <ReactPlayer\n              className={style.reactPlayer}\n              ref={playerRef}\n              url={mediaSource}\n              playing={playing}\n              onReady={handleReady}\n              onProgress={handleProgress}\n              progressInterval={500}\n              width=\"100%\"\n              height=\"100%\"\n            />\n          </div>\n          <div className={style.control}>\n            <div\n              className={style.progressBarWrapper}\n              onClick={handleProgressBarClick}\n            >\n              <div\n                className={style.progressBar}\n                style={{\n                  width: String(progress * 100) + \"%\"\n                }}\n              ></div>\n            </div>\n            <div className={style.playControl}>\n              <img\n                alt=\"play\"\n                className={style.playButton}\n                onClick={() => (playing ? handlePause() : handlePlay())}\n                src={playing ? \"/pause.png\" : \"/play.png\"}\n              />\n              <img\n                alt=\"pause\"\n                className={style.fullscreenButton}\n                onClick={toggleFullsreen}\n                src=\"/fullscreen.png\"\n              />\n            </div>\n          </div>\n        </div>\n        <div className={style.buttons}>\n          <Button onClick={handleInviteLinkCopy}>\n            {inviteLinkCopied ? \"✅\" : \"😃\"}&nbsp; Copy invite link\n          </Button>\n          <Button href=\"/room/\">🏠&nbsp;New room</Button>\n        </div>\n      </div>\n      <input\n        className={style.hidden}\n        readOnly\n        type=\"text\"\n        value={window.location}\n        id=\"invite-link\"\n      />\n      <div className={style.links}>\n        <Link href=\"/imprint\">Imprint</Link>\n        <Link href=\"/about\">About</Link>\n        <Link href=\"#\" onClick={rickRoll}>\n          Free Bitcoin\n        </Link>\n      </div>\n    </>\n  )\n}\n\nexport default App\n","import React from \"react\"\nimport Button from \"./components/Button\"\n// import { Link } from \"wouter\"\nimport style from \"./Subpage.module.css\"\n\nfunction Subpage({ children }) {\n  return (\n    <div\n      className={style.wrapper}\n      style={{ animation: \"fadeIn .5s ease-in-out\" }}\n    >\n      <Button onClick={() => window.history.back()}>\n        🍿&nbsp;Go back\n      </Button>\n      {children}\n    </div>\n  )\n}\n\nexport default Subpage","import { Redirect, Route, Switch } from \"wouter\"\nimport App from \"./App\"\nimport Subpage from \"./Subpage\"\n\nfunction Router() {\n  const getRandomId = () => Math.random().toString(36).substr(2, 12)\n  return (\n    <Switch>\n      <Route path=\"/imprint\">\n        <Subpage>\n          <h1>Imprint</h1>\n          <p>\n            Leander Tolksdorf<br />\n            Onckenstr. 15<br />\n            12435 Berlin<br />\n            Germany\n          </p>\n          <p>\n            admin@leander-tolksdorf.de\n          </p>\n        </Subpage>\n      </Route>\n      <Route path=\"/about\">\n        <Subpage>\n          <h1>\n            About this project\n          </h1>\n          <p>\n            TogetherTV was built for fun and educational purposes.\n          </p>\n          <p>\n            The app uses <a href=\"https://expressjs.com/\">ExpressJS</a> and <a href=\"https://developer.mozilla.org/de/docs/Web/API/WebSockets_API\">WebSockets</a> for the backend and <a href=\"https://reactjs.org/\">React</a> for the frontend.\n            TogetherTV is open source. The code is available and open for contribution on GitHub.\n          </p>\n          <h1>\n            About the author\n          </h1>\n          <p>\n            I'm Leander Tolksdorf, a web developer from Berlin, Germany.<br />\n            You can visit my website on <a href=\"https://farbig.media\">farbig | media</a>.\n          </p>\n        </Subpage>\n      </Route>\n      <Route path=\"/room/:id\">\n        {params => <App id={params.id} />}\n      </Route>\n      <Route>\n        <Redirect to={`/room/${getRandomId()}`} />\n      </Route>\n    </Switch>\n  )\n}\n\nexport default Router","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport Router from \"./Router\"\nimport \"./global.css\"\n\nReactDOM.render(\n  <React.StrictMode>\n    <Router />\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"Button_button__3QF_k\",\"inner\":\"Button_inner__3Quww\"};"],"sourceRoot":""}